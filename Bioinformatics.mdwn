# Bioinformatics 

> Mac Version 1.0  //  Update: 18/02/20


This will provide a basic overview of setting up your computer for bioinformatic analysis of RNAseq data. 

---


 * [Basic Programmes for Installation](#basic-programmes-for-installation)
   * [Additional Packages](#additional-packages)
 * [Overview of Analysis Process](#overview-of-analysis-process)
 * [Using Anaconda to Run Salmon](#using-anaconda-to-run-salmon)
 * [Additional Resources](#additional-resources)



## Basic Programmes for Installation

Most of our anaylsis will be done using R or Command Line language. 
Some steps also involve Python, but in the terminal and is simple to follow. 
Some basic programmes need to be installed (see below) and you will also need 
an account with Imperail HPC and connect to the cluster (more about this later).

* Install the [latest](https://cran.r-project.org/bin/macosx/ "R") version of R [R 3.6.2]
* Install [RStudio](https://rstudio.com/products/rstudio/download/ "RStudio") [chooose the free desktop version]
* Install [Visual Studio Code](https://code.visualstudio.com "VSC")
    * This is a great addition to RStudio and while I prefer to use RStudio if 
    I am purely coding in R, VSCode enables cross-langauge compatibility and
    Git commands built-in 
* Set up a [Git Hub](https://github.com "Git") account [again choose the free option]
* [Docker](https://docker-curriculum.com "Docker") is another nice application to run code in a clean environment 



### Additional Packages

You will also need to install some additional packages in order to run R and RStudio 
correctly and Mac doesn't come with these pre-installed. 

* [XQuartz](https://www.xquartz.org "XQuartz") [latest version] 
    > Note: always re-install XQuartz when upgrading to a new major version
* [Clang 7.0.0.](https://cran.r-project.org/bin/macosx/tools/ "clang")
* [GNU Fortran 6.1](https://cran.r-project.org/bin/macosx/tools/ "GNU")
    > Note: you don't need Tcl/Tk as R already comes with it. 
* Command Line Tools and Developer Tools:
    1. Install XCode [use App Store, you will also need to make a free account]
    2. To install the command line tools, go into Terminal app and use:
           
        ```{r}
        xcode-select --install
        ```

        This will install the command line tools. Additional info can be found [here](https://docs.brew.sh/Installation "clt")
    3.  In terminal, use the command:
            
        ```{r}
        R
        options(menu.graphics=F)
        install.packages("processx")
        ```

        After you hit enter for `install.packages("processx")`, you will see a list of mirrors come up. These basically help download your packages from a closer server. Use the UK - Bristol server [try Bristol first and if it doesn't work then use the UK - London server]. 
        You need this package to install the development tools. Additional info can be found [here](https://github.com/r-lib/processx "processx"). 
    4. In terminal, use the command:
           
        ```{r}
        install.packages("devtools")
        ```

        This will install the developer tools. Additional info can be found [here](https://www.r-project.org/nosvn/pandoc/devtools.html "devtools"). 

    5. Once you have done this, you will need to restart RStudio, R, and the terminal too. 


## Overview of Analysis Process

1. Acquire raw data - either in the form of fastq or fasta files. 
    * You can use the SRA run selector to download raw data from GEO [see [get_SRR](https://github.com/fm2817/get_SRR "get_SRR"). Or you will need to demultiplex your reads using the `bcl2fastq` packages on RStudio. 

2. Align your sequences to a reference sequence and map to genes. We use Salmon to do this. Salmon is able to produce a highly-accurate, transcript-level quantification estmiates from RNA-seq data. [see: [Using Anaconda to Run Salmon](#using-anaconda-to-run-salmon)]. 

> Additional details: 
> https://combine-lab.github.io/salmon/getting_started/ 
> https://github.com/COMBINE-lab/salmon

3. Carry out analysis using DESeq2, edgeR or another appropriate analysis method. 
    * DESeq2: [beginner's guide](https://bioc.ism.ac.jp/packages/2.14/bioc/vignettes/DESeq2/inst/doc/beginner.pdf "beginner"), [vignettes](http://bioconductor.org/packages/devel/bioc/vignettes/DESeq2/inst/doc/DESeq2.html "DESeq2 Vignettes"), and [DESeq2 package](https://bioconductor.org/packages/release/bioc/html/DESeq2.html "DESeq2 package").
    * edgeR: [vignettes](http://bioconductor.org/packages/release/bioc/vignettes/edgeR/inst/doc/ "edgeR Vignettes"), and [edgeR package](https://bioconductor.org/packages/release/bioc/html/edgeR.html "edgeR package").
        

> Note: I recommend using DESeq2. Also [here](https://www.biostars.org/p/284775/ "DESeq2vsEdgeR") is a really nice explanation of the differences.


## Using Anaconda to Run Salmon 

Salmon is a fast program to produce highly-accurate, transcript-level quantification estimates from RNA-seq data. In order to run Salmon, since it is a Linux/Unix based system you will need `Anaconda` in order to install it. This [link](https://combine-lab.github.io/salmon/getting_started/ "Anaconda") is a great beginners guide to installing and using Salmon. 

You will need to install `Anaconda`: https://www.anaconda.com/distribution/. Click the Download link on the bottom left to install Python 3.7 version. Follow the instructions on the installer. You can use Anaconda both in Terminal and in the Anaconda-Navigator desktop app. Once you've downloaded Anaconda, head [here](https://anaconda.org/bioconda/salmon) to download and install Salmon (you can use either of the links and put the command into Terminal). After you have installed Salmon, head [here](https://combine-lab.github.io/salmon/getting_started/ "install Salmon") to set up your conda environment for Salmon; 

```{r}
conda config --add channels conda-forge
conda config --add channels bioconda
conda create -n salmon salmon
```

This will create a new environment in Anaconda where your salmon package is installed. 
To activate your conda environment:

```{r}
conda activate salmon
```

Then use to check that salmon is running on your system correctly. 

```{r}
salmon -h
```

Useful links:
Combine lab salmon [GitHub](https://github.com/COMBINE-lab/salmon)
[Documentation](https://salmon.readthedocs.io/en/latest/)
Imperial's [Wiki](https://wiki.imperial.ac.uk/display/HPC/Conda) has some additional info and functions. 


> Note: if in Terminal when you open it and you get (base) Username. If you want to switch back to Z Shell, shell, bash, shell, or zsh


## Additional Resources

Installing packages via [Homebrew](https://brew.sh) REALLY RECOMMEND INSTALLING HOMEBREW! It will make your life easier by installing packages with all dependencies (aka other packages it needs to run).

Kirill's [GitHub](https://github.com/ks4471)

[Genome mapping](https://www.gencodegenes.org/mouse/) (recommended by Kirill)

Also checkout Fastq Storage section of [get_SRR](https://github.com/fm2817/get_SRR) this has some great links and information about Imperial's HPC cluster and Research computing! In addition, [ARCHER](https://www.archer.ac.uk/training/courses/) also provides some great information on HPC - you can see individual course material [here](https://www.archer.ac.uk/training/past_courses.php). 


Need to sort:
https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3398141/
https://bioconductor.org/packages/release/bioc/html/NOISeq.html
https://rdrr.io/bioc/sva/man/ComBat.html
https://rdrr.io/bioc/sva/man/svaseq.html

https://hcs7806.readthedocs.io/en/latest/RNA-Seq/

https://hcs7806.readthedocs.io/en/latest/RNA-Seq/

"colorout": https://github.com/jalvesaq/colorout
addR: https://github.com/ks4471/addR






