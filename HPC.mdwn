# High Performance Computing

> Mac Version  //  Update: 30/03/20 Adapted from [Beginner's guide to HPC at Imperial](https://imperialcollegelondon.app.box.com/s/fsoiljuf43f7ko4tfvqifbyrfj8yslbi) 


This will provide a basic overview of using the High Performance Computing service offered by Imperial. The Research Computing Service at Imperial offers several services including acces to HPC and reserach data storage. 

---


 * [Access](#access)
    * [Ethernet](#ethernet)
    * [VPN](#vpn) 
 * [Why use HPC?](why-use-hpc?)
 * [Using the cluster](using-the-cluster)
   * [Operating in Terminal](operating-in-terminal)
 * [Globus](globus)
 * [HPC Courses](#hpc-courses)
 * [Additional Information](additional-information)
  


---


## Access

You will need to get access to the [Research Computing Service](https://api.rcs.imperial.ac.uk/groups/manage/hpc-access/). Simone already has an account `hpc-sdigiova`. If you are a post-doc, PhD or research postgrad student, you will need to ask Ilaria to register you.

> [Getting started](https://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/support/getting-started/).

You will also need access to the Imperial network. 

### Ethernet 

If you are on Campus, I recommend connecting directly to the Imperial network via an ethernet cable. For Mac, since the new laptops only have a USB-C connection, you will need a USB-C to ethernet adaptor - you can buy these at any Apple store or [online](https://www.amazon.co.uk/Belkin-F2CU040btBLK-Ethernet-Certified-Compatible/dp/B014FBQ738). 

Next, you will need to register the adaptor with ICT. Use ICT Ask to submit a request or visit them during their drop-in hours (13:00-14:00). 

Once you have access, you can connect to the [research data store](https://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/rds/) by going to `Go > Connect to Server > smb://rds.imperial.ac.uk/RDS/user/yourusername > connect`. 

If you still need help, check out [this video](https://vimeo.com/302461588).

> Note: ICT is located in the basement of the Common Wealth Building. If you use the elecators, turn right as you come out of them, then turn left. Go all the way to the end of the hallway, go through the doors, turn right and go through the doors again. Their office is the first door on the right. There should be a sign saying ICT office. 

### VPN

If you are working from home, you will need access to the Imperial Network via VPN. I use both [Tunnelblick](https://tunnelblick.net) and [Viscosity](https://www.sparklabs.com/viscosity/)
but note that with Viscosity, you only have a 30 day trial - maybe we can purchase a license for the lab later on. I use Tunnelblick to access files via [FileZilla](https://filezilla-project.org). This is a great way to view and organise your files. Once you have FileZilla downloaded and open, where it says Host enter: `sftp://login.hpc.ic.ac.uk`, under Username enter `yourusername` and enter your password under Password. Leave Port blank. Now click Quickconnect. 

![FileZilla](FileZilla_Image.png)

If you don't want to use FileZilla, you can also connect to the RDS with Finder on your Mac by: Finder -> Go -> Connect to Server -> Server address. The address you enter is `smb://rds.imperial.ac.uk/RDS/user/your_username`. Under your_username, enter your Imperial username e.g. fm2817. 

You can also use the command line:

To copy files form the current directory on your machine to your home directory on RDS:

   ```zsh
   scp file.txt username@login.hpc.ic.ac.uk:~
   ```

To copy files from your home directory on RDS to the current directoy on your machine:

   ```zsh
   scp username@login.hpc.ic.ac.uk:~/file2.txt
   ```

e.g. `scp/Users/katerina/Desktop/file3.txt  username@login.hpc.ic.ac.uk:/rds/general/user/kmichali/home/projectx`


## Why use HPC?

If you plan on carrying out Bioinformatic Analysis, high performance computing will make your life easier.

Some Basics:

A **computer cluster** consists of a set of connected computers that work together - in this way, they can be viewed as a single system.

![computer](computer_cluster.png) 

Inside one of these computer racks, are individual computers aka a compute **node**.

![node](node.png)

Compute nodes are made up of multiple **cores** that can access the same memory. A core is the basic computation unit inside a processor that can run a single process. HPC's processors contain up to 14 cores. 

A **Job** is a program you run on the cluster

A **submit job** is the  instruction sent to the cluster to run your program

**Memory** refers to the main memory or RAM - fast memory directly connected to the processor. 

**Serial code** refers to running a program on one core

**Parallel code** referes to running a program on two or more cores. 

What can these clusters do? The cluster can serve to offload code execution from your laptpo/workstation - basically makes your life easier by freeing up your computer which would be otherwise occupied by code that tuns too long or needs too much memory or disk space. 
They are particularily useful if you need to run multiple tasks at the same time - serial/parallel code. 

Different types of jobs:
* High-throughput tasks - large number of relatively small jobs
* Parallel jobs on a single node
* Parallel jobs on multiple nodes (from 2 to 270 nodes)
* Large single node memory jobs (up to TB of memory)
* Jobs using GPUs (such as machine learning tasks)
* Long-running jobs (up to 1000 hr)


## Using the Cluster 

All computers in the HPC resource are connected to one parallel filesystem - [Research Data Store (RDS)](http://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/support/getting-started/data-management/). When you have an account, you will have access to:
* your home directory `$HOME` - personal working space; 1 TB allocation (up to 10 mil files)
* temorpary stoarge `$EPHEMERAL` - addditional individual working space, unlimited allocation, but files are deleted after 30 days
* allocated project space `$RDS_PROJECT` - your project allocations: `genomics-data`. 

### Operating in Termianl 

The HPC system is a linus operating system that uses Bash shell. You can work directly in your Terminal. 
To login: 
   ```zsh
   ssh your_username@login.hpc.ac.ac.uk
   ```

You will see something like this when you've executed your command:

![HPC environment](HPC_environ.png)

Here you can see how much space you have used in your Home and Ephemeral folders. 




blah blah 
https://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/support/getting-started/using-ssh/
https://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/support/getting-started/


## Globus

You can use [Globus](https://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/rds/globus/) to share and transfer data from your RDS to an external site. [Log into Globus][1], select **Imperial College London** from the trusted organisations in the drop down list.

[1]: <https://auth.globus.org/p/login?redirect_uri=%2Fv2%2Foauth2%2Fauthorize%3Fclient_id%3D89ba3e72-768f-4ddb-952d-e0bb7305e2c7%26scope%3Durn%253Aglobus%253Aauth%253Ascope%253Aauth.globus.org%253Aview_identities%2520urn%253Aglobus%253Aauth%253Ascope%253Anexus.api.globus.org%253Agroups%2520urn%253Aglobus%253Aauth%253Ascope%253Atransfer.api.globus.org%253Aall%26response_type%3Dtoken%26redirect_uri%3Dhttps%253A%252F%252Fapp.globus.org%252Flogin%26redirect_name%3DGlobus%2520Web%2520App%26state%3Dgceadlbt2ki&response_type=token&client_id=89ba3e72-768f-4ddb-952d-e0bb7305e2c7&scope=urn%3Aglobus%3Aauth%3Ascope%3Aauth.globus.org%3Aview_identities+urn%3Aglobus%3Aauth%3Ascope%3Anexus.api.globus.org%3Agroups+urn%3Aglobus%3Aauth%3Ascope%3Atransfer.api.globus.org%3Aall&redirect_name=Globus+Web+App> "Globus Login"


![Globus Login](https://www.imperial.ac.uk/ImageCropToolT4/imageTool/uploaded-images/Globus-login-page--tojpeg_1564157295617_x2.jpg "Globus Login")


The first time you log in, you will need to register for a Globus account. 


## HPC Courses

Imperial offers courses on using the HPC system. You can find dates [here](https://wiki.imperial.ac.uk/display/HPC/Courses). I would recommend the `Beginner's guide to HPC at Imperial - from serial jobs to data parallelism` course. Before going on the course you will have to have some knowledge of the Linux command line such as the management comands `pwd, mkdir, cd, cp, mv, rm, cat, head, tail` and the nano text editor. If you are unfamiliar with these terms, please have a look [here](https://wiki.imperial.ac.uk/pages/viewpage.action?spaceKey=HPC&title=Command+line) first before the course. 


## Additional Information

Who to contact?

![contact](contact.png)

* User support - rcs-support@imperial.ac.uk or http://imperial.service-now.com/ask
* Website - imperial.ac.uk/ict/rcs
* Getting started - http://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/support/getting-started/
* Weekly drop-in clinincs: http://www.imperial.ac.uk/admin-services/ict/self-service/research-support/rcs/support/attend-a-clinic/
* Service status - https://selfservice.rcs.imperial.ac.uk/saml/acs/
* Self-service selfservice.rcs.imperial.ac.uk (group management, hob monitoring and extensions, etc.)

> Note: drop-in clinics are planned to open at Hammersmith twice a month soon. 